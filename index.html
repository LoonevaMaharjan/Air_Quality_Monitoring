<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
  <style>
    body {
      background: linear-gradient(135deg, #1a1a2e, #16213e);
      color: #fff;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
    }
    .navbar {
      display: flex;
      justify-content: center;
      gap: 2rem;
      padding: 1rem;
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(10px);
    }
    .navbar a {
      color: #00f0ff;
      text-decoration: none;
      font-weight: bold;
      transition: color 0.3s ease;
    }
    .navbar a:hover {
      color: #00c0ff;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      padding: 2rem;
    }
  </style>
</head>
<body>
  <div class="navbar">
    <a href="index.html" class="active">Dashboard</a>
    <a href="tokens.html">Tokens</a>
    <a href="map.html">Map</a>
  </div>

  <h1>AQI Dashboard</h1>

  <div class="grid">
    <div class="chart-card">
      <p id="pm25Value">PM2.5: Loading...</p>
    </div>
    <div class="chart-card">
      <p id="co2Value">CO2: Loading...</p>
    </div>
    <div class="chart-card">
      <p id="tempValue">Temperature: Loading...</p>
    </div>
    <div class="chart-card">
      <p id="aqiValue">AQI: Loading...</p>
    </div>
  </div>

  <script>
    async function fetchData(blobId) {
      try {
        const res = await fetch(`https://aggregator.testnet.walrus.atalma.io/v1/blobs/${blobId}`);
        
        if (!res.ok) {
          throw new Error("Failed to fetch data from API");
        }

        const data = await res.json();
        console.log("API Response:", data);  // Log the response data

        // Assuming 'data' is a single object, directly access its properties
        const pm25 = data.pm25;
        const co2 = data.co2_ppm;
        const temp = data.temperature;
        const aqi = calculateAQI(pm25, co2, temp);  // Calculate AQI from available data

        // Update the page with the fetched values
        document.getElementById('pm25Value').textContent = `PM2.5: ${pm25}`;
        document.getElementById('co2Value').textContent = `CO2: ${co2} ppm`;
        document.getElementById('tempValue').textContent = `Temperature: ${temp} Â°C`;
        document.getElementById('aqiValue').textContent = `AQI: ${aqi}`;

      } catch (error) {
        console.error("Error fetching data: ", error);
      }
    }

    function calculateAQI(pm25, co2, temp) {
      // This is a placeholder function. Implement your AQI calculation logic based on the data you have.
      return Math.round((pm25 + co2 / 100 + temp) / 3);  // Dummy calculation
    }

    const blobId = "0mOIQG6GS38jDtyH5aGePw39lesp9dyBebpf3f-RJnA";  // Use the correct blobId
    fetchData(blobId);  // Fetch and display the data
  </script>
</body>
</html>
